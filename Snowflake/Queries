import os
from os.path import join, dirname
from dotenv import load_dotenv
import os
from os.path import join, dirname
from dotenv import load_dotenv

# Get the absolute path of the current script file
script_path = os.path.abspath(os.getcwd() + os.sep + os.pardir)

# Construct the path to the .env file
dotenv_path = join(script_path, '.env')
load_dotenv(dotenv_path)

# Get the credentials from .env
SF_ACCOUNT    = os.getenv('SNOWFLAKE_ACCOUNT')
SF_USER       = os.getenv('SNOWFLAKE_USER')
SF_WAREHOUSE  = os.getenv('SF_WAREHOUSE')
SF_DATABASE   = os.getenv('SNOWFLAKE_DATABASE')
SF_SCHEMA     = os.getenv('SF_SCHEMA')
SF_PASSWORD   = os.getenv('SNOWFLAKE_PASSWORD')

import snowflake.connector
# fire up an instance of a snowflake connection
connection = snowflake.connector.connect (
account  = SF_ACCOUNT,
user     = SF_USER,
password = SF_PASSWORD,
database = SF_DATABASE,
warehouse = SF_WAREHOUSE
)

cs = connection.cursor()
try:
  cs.execute("""select * from CRUNCHBASE_BASIC_COMPANY_DATA.PUBLIC.ORGANIZATION_SUMMARY
where city='San Francisco';""")
except Exception as e:  
  raise e
finally:  
  cs.close() 
connection.close()
