import os
from os.path import join, dirname
from dotenv import load_dotenv
from snowflake.snowpark import Session


# Get the absolute path of the current script file
script_path = os.path.abspath(os.getcwd() + os.sep + os.pardir)

print (script_path)
# Construct the path to the .env file
dotenv_path = join(script_path, '.env')
load_dotenv(dotenv_path)

# Get the credentials from .env
connection_parameters = {
"account"    : os.getenv('SNOWFLAKE_ACCOUNT'),
"user"       : os.getenv('SNOWFLAKE_USER'),
"warehouse"  : os.getenv('SF_WAREHOUSE'),
"database"   : os.getenv('SNOWFLAKE_DATABASE'),
"schema"     : os.getenv('SF_SCHEMA'),
"password"   : os.getenv('SNOWFLAKE_PASSWORD')
}

# fire up an instance of a snowflake connection
new_session = Session.builder.configs(connection_parameters).create()

# Read docs at https://docs.snowflake.com/en/developer-guide/snowpark/python/working-with-dataframes#label-snowpark-python-dataframe-construct for more
df_table = new_session.table("CRUNCHBASE_BASIC_COMPANY_DATA.PUBLIC.ORGANIZATION_SUMMARY")
df_table.show()

# close the session
new_session.close()


